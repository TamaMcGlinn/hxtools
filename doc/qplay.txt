
Usage: qplay [-q part] [-i part] [-r rate] [FILE...] |
       oplay -Ms48000 -

  -q part        part to mix square waves in (default: 1.0)
  -i part        part to mix sine waves in (default: 1.0)
  -r rate        sample rate (default: 48000 Hz)

qplay will convert QBasic PLAY commands to linear 16-bit PCM (not .wav, but
raw). By default, it will mix 1:1 square:sine waves to give a medium tone
hardness.

The file format qplay expects is of course not BASIC, but raw PLAY commands.
Lines that start with a '#' are ignored. Variable definitions take the form

	$var commandstring

and variable calls are made with the "X(var)" command. (This is different from
the "X" + VARPTR$() QBasic used, of course!)

The format of the PLAY commands is described in the QBasic manpage,
shown below.


---- PLAY Statement (Music) ---------------------------------------------------

 * <Octave and Tone Commands>
     o n      Set current octave (n = 0-6).
     < or >   Move up or down one octave.
     A - G    Play A, B, ... G in current octave (+ or # = sharp,
              - = flat).
     Nn       Play a znote (n = 0-84, where 0 is a rest).

 * <Duration and Tempo Commands>
     Ln        Sets length of a note (n = 1-64, where 64 is 64th note).
     ML        Each note plays full length.   [Legato]
     MN        Each note plays 7/8 of length. [Normal]
     MS        Each note plays 3/4 of length. [Staccato]
     Pn        Pause for the duration of n quarternotes (n = 1-64).
               [sic: pause for the duration of a Nth note)
     Tn        Sets tempo (n = 32-255, 120 quarter notes per minute
               default).

 * <Foreground/Background Operation Commands>
     MF        Plays music in foreground.
     MB        Plays music in background.

  * To execute substrings within a PLAY command, use a command of
    the form:

      "X" + VARPTR$(stringexpression)

      [ Note: qplay uses X(varname), see above. ]

---- PLAY Statement (Music) - Octave and Tone ---------------------------------
Octave and Tone Commands

  Octave     Action
  o n        Sets the current octave. There are seven octaves, numbered 0-6.
  >          Increases octave by 1. Octave cannot go beyond 6.
  <          Decreases octave by 1. Octave cannot drop below 0.

  Tone       Action
  A-G        Plays a note in the range A-G. The number sign (#) or the
             plus sign (+) after a note specifies sharp; a minus sign (-)
             specifies flat.
  N n        Plays note n. The range for n is 0-84 (in the seven possible
             octaves, there are 84 notes); n = 0 means a rest.

  Suffixes   Action
  # or +     Follows a specified note and turns it into a sharp.
  -          Follows a specified note and turns it into a flat.


---- PLAY Statement (Music) - Duration and Tempo Commands ---------------------
Duration and Tempo Commands

  Duration   Action
  L n        Sets the length of each note. L4 is a quarter note,
             L1 is a whole note, etc. The range for n is 1-64.
             The length may also follow the note when a change of
             length only is desired for a particualr note. For example,
               A16 can be equivalent to L16A.
  MN         Sets "music normal" so that each note will play 7/8
             of the time determined by the length (L).
  ML         Sets "music legato" so that each note will play the full
             period set by lengt (L).
  MS         Sets "music staccato" so that each note will play 3/4 of
             the time determined by the length (L).

  Tempo      Action
  P n        Specifies a pause, ranging from 1-64. This option
             corresponds to the length of each note, set with L n.
  T n        Sets the "tempo", or the number of L4 quarter notes in one
             minute. The range for n is 32-255. The default for n is 120.

    Note: Because of the slow clock-interrupt rate, some notes will not
          play at higher tempos (L64 at T255, for example).

    [ This problem does not apply to qplay when used with PCM output. ]

  .          A period after a note causes the note to play 3/2 times
             the length determined by L (length) times T (tempo). The
             period has the same meaning as in a musical score.
             Multiple periods can appear after a note. Each period
             adds a length equal to one-half the length of the
             previous period. For example,
               * The command A. plays 1 + 1/2, or 3/2 times the length
               * A.. plays 1 + 1/2 + 1/4, or 7/4 times the length.
             Periods can appear after a pause (P). In this case, the pause
             length is scaled in the same way notes are scaled.
